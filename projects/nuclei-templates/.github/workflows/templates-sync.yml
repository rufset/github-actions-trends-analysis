name: Sync Repositories Workflow
on:
  push:
    paths:
    - '.new-additions'
    - 'cloud/aws/acm/acm-cert-expired.yaml'
    - 'cloud/aws/acm/acm-cert-renewal-30days.yaml'
    - 'cloud/aws/acm/acm-cert-renewal-45days.yaml'
    - 'cloud/aws/acm/acm-cert-validation.yaml'
    - 'cloud/aws/acm/acm-wildcard-cert.yaml'
    - 'cloud/aws/aws-code-env.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-data-events.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-disabled.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-dup-logs.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-global-disabled.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-integrated-cloudwatch.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-log-integrity.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-logs-not-encrypted.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-mfa-delete.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-mgmt-events.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-public-buckets.yaml'
    - 'cloud/aws/cloudtrail/cloudtrail-s3-bucket-logging.yaml'
    - 'cloud/aws/cloudtrail/s3-object-lock-not-enabled.yaml'
    - 'cloud/aws/cloudwatch/cw-alarm-action-set.yaml'
    - 'cloud/aws/cloudwatch/cw-alarms-actions.yaml'
    - 'cloud/aws/ec2/ec2-imdsv2.yaml'
    - 'cloud/aws/ec2/ec2-public-ip.yaml'
    - 'cloud/aws/ec2/ec2-sg-egress-open.yaml'
    - 'cloud/aws/ec2/ec2-sg-ingress.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-cifs.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-dns.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-ftp.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-http.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-https.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-icmp.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-memcached.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-mongodb.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-mssql.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-mysql.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-netbios.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-opensearch.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-oracle.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-pgsql.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-rdp.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-redis.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-smtp.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-ssh.yaml'
    - 'cloud/aws/ec2/ec2-unrestricted-telnet.yaml'
    - 'cloud/aws/ec2/publicly-shared-ami.yaml'
    - 'cloud/aws/ec2/unencrypted-aws-ami.yaml'
    - 'cloud/aws/iam/iam-access-analyzer.yaml'
    - 'cloud/aws/iam/iam-expired-ssl.yaml'
    - 'cloud/aws/iam/iam-full-admin-privileges.yaml'
    - 'cloud/aws/iam/iam-key-rotation-90days.yaml'
    - 'cloud/aws/iam/iam-mfa-enable.yaml'
    - 'cloud/aws/iam/iam-password-policy.yaml'
    - 'cloud/aws/iam/iam-root-mfa.yaml'
    - 'cloud/aws/iam/iam-ssh-keys-rotation.yaml'
    - 'cloud/aws/iam/iam-unapproved-policy.yaml'
    - 'cloud/aws/iam/iam-user-password-change.yaml'
    - 'cloud/aws/iam/ssl-cert-renewal.yaml'
    - 'cloud/aws/rds/aurora-copy-tags-snap.yaml'
    - 'cloud/aws/rds/aurora-delete-protect.yaml'
    - 'cloud/aws/rds/iam-db-auth.yaml'
    - 'cloud/aws/rds/rds-backup-enable.yaml'
    - 'cloud/aws/rds/rds-deletion-protection.yaml'
    - 'cloud/aws/rds/rds-encryption-check.yaml'
    - 'cloud/aws/rds/rds-event-notify.yaml'
    - 'cloud/aws/rds/rds-event-sub-enable.yaml'
    - 'cloud/aws/rds/rds-event-sub.yaml'
    - 'cloud/aws/rds/rds-gp-ssd-usage.yaml'
    - 'cloud/aws/rds/rds-public-snapshot.yaml'
    - 'cloud/aws/rds/rds-public-subnet.yaml'
    - 'cloud/aws/rds/rds-ri-payment-fail.yaml'
    - 'cloud/aws/rds/rds-snapshot-encryption.yaml'
    - 'cloud/aws/s3/s3-access-logging.yaml'
    - 'cloud/aws/s3/s3-auth-fullcontrol.yaml'
    - 'cloud/aws/s3/s3-bucket-key.yaml'
    - 'cloud/aws/s3/s3-bucket-policy-public-access.yaml'
    - 'cloud/aws/s3/s3-mfa-delete-check.yaml'
    - 'cloud/aws/s3/s3-public-read-acp.yaml'
    - 'cloud/aws/s3/s3-public-read.yaml'
    - 'cloud/aws/s3/s3-public-write-acp.yaml'
    - 'cloud/aws/s3/s3-public-write.yaml'
    - 'cloud/aws/s3/s3-server-side-encryption.yaml'
    - 'cloud/aws/s3/s3-versioning.yaml'
    - 'cloud/aws/vpc/nacl-open-inbound.yaml'
    - 'cloud/aws/vpc/nacl-outbound-restrict.yaml'
    - 'cloud/aws/vpc/nat-gateway-usage.yaml'
    - 'cloud/aws/vpc/unrestricted-admin-ports.yaml'
    - 'cloud/aws/vpc/vpc-endpoint-exposed.yaml'
    - 'cloud/aws/vpc/vpc-endpoints-not-deployed.yaml'
    - 'cloud/aws/vpc/vpc-flowlogs-not-enabled.yaml'
    - 'cloud/aws/vpc/vpn-tunnel-down.yaml'
    - 'code/cves/2024/CVE-2024-3094.yaml'
    - 'http/cves/2022/CVE-2022-0424.yaml'
    - 'http/cves/2024/CVE-2024-0337.yaml'
    - 'http/cves/2024/CVE-2024-26331.yaml'
    - 'http/cves/2024/CVE-2024-2879.yaml'
    - 'http/cves/2024/CVE-2024-3273.yaml'
    - 'http/default-logins/allnet/allnet-default-login.yaml'
    - 'http/default-logins/asus/asus-rtn16-default-login.yaml'
    - 'http/default-logins/asus/asus-wl500g-default-login.yaml'
    - 'http/default-logins/asus/asus-wl520GU-default-login.yaml'
    - 'http/default-logins/barco-clickshare-default-login.yaml'
    - 'http/exposed-panels/akhq-panel.yaml'
    - 'http/exposed-panels/beyondtrust-priv-panel.yaml'
    - 'http/exposed-panels/mitel-micollab-panel.yaml'
    - 'http/exposed-panels/mitric-checker-panel.yaml'
    - 'http/exposed-panels/ni-web-based-panel.yaml'
    - 'http/exposed-panels/outsystems-servicecenter-panel.yaml'
    - 'http/exposed-panels/powerchute-network-panel.yaml'
    - 'http/exposed-panels/rtm-web-panel.yaml'
    - 'http/exposed-panels/suprema-biostar-panel.yaml'
    - 'http/exposed-panels/zenml-dashboard-panel.yaml'
    - 'http/exposures/apis/aspnet-soap-webservices-asmx.yaml'
    - 'http/misconfiguration/apple-cups-exposure.yaml'
    - 'http/misconfiguration/dlink-unauth-cgi-script.yaml'
    - 'http/misconfiguration/helm-dashboard-exposure.yaml'
    - 'http/misconfiguration/intelbras-dvr-unauth.yaml'
    - 'http/misconfiguration/thanos-prometheus-exposure.yaml'
    - 'http/technologies/citrix-xenmobile-version.yaml'
    - 'http/technologies/splunkhec-detect.yaml'
    - 'http/vulnerabilities/other/quick-cms-sqli.yaml'
  workflow_dispatch:
jobs:
  triggerRemoteWorkflow:
    if: github.repository == 'projectdiscovery/nuclei-templates'
    runs-on: ubuntu-latest
    steps:
    - name: Trigger Remote Workflow with curl
      run: |
        curl -i -s -k -X 'POST' -H 'Host: api.github.com' -H "Authorization: token ${{ secrets.GTOKEN }}" --data-binary $'{\"ref\":\"main\"}' 'https://api.github.com/repos/projectdiscovery/early-templates/actions/workflows/reposync.yml/dispatches'
